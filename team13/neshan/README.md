# اتصال به APIهای نشان (neshan.ir)

این پوشه تمام ارتباطات **بک‌اند** و **فرانت** با سرویس‌های نشان را متمرکز می‌کند.

## کلیدها (ذخیره شده)

دو کلید در `.env` در ریشهٔ پروژه قرار گرفته‌اند:
- **NESHAN_API_KEY_SERVICE** — برای فراخوانی از بک‌اند (مسیریابی، reverse، جستجو)
- **NESHAN_API_KEY_WEB** — برای فرانت/نقشه در صورت نیاز

## مراحل بعدی (تیکه‌تیکه)

2. **مسیریابی (Direction / ETA)**  
   آدرس دقیق endpoint (مثلاً `https://api.neshan.org/v5/direction`) و در صورت نیاز نمونهٔ درخواست و پاسخ (JSON).  
   → در `routing.py` وصل و فیکس می‌شود.

3. **تبدیل نقطه به آدرس (Reverse Geocoding)**  
   آدرس endpoint و نمونهٔ پاسخ.  
   → در `geocoding.py` وصل می‌شود.

4. **جستجو / Autocomplete**  
   آدرس endpoint و نمونهٔ پاسخ برای جستجوی آدرس.  
   → در `search.py` وصل می‌شود و در فرانت (باکس جستجو و مسیریابی) استفاده می‌شود.

## فایل‌های این پوشه

| فایل | کاربرد |
|------|--------|
| `config.py` | خواندن `NESHAN_API_KEY` از settings/env و آدرس پایهٔ API |
| `routing.py` | مسیریابی و ETA بین دو نقطه برای بک‌اند و (در صورت نیاز) فرانت |
| `geocoding.py` | تبدیل مختصات به آدرس (reverse geocode) |
| `search.py` | جستجو / autocomplete برای باکس آدرس در نقشه و مسیر |

## بعد از دادن هر تیکه

- **بک‌اند:** در `views.py` و `geo_utils.py` از همین ماژول (`team13.neshan`) استفاده می‌شود؛ با دادن endpoint و نمونه، همان فایل‌ها را به‌روز و تست می‌کنیم.
- **فرانت:** در JS (مثلاً `map_data.js`, `routes_autocomplete.js`) آدرس درخواست و فرمت پاسخ را با API نشان هم‌خوان می‌کنیم.
- **دیتابیس:** در صورت نیاز به ذخیرهٔ مسیر/نقشهٔ نشان، فقط رفرنس (مثلاً آدرس یا شناسه) در دیتابیس ذخیره می‌شود؛ خود API نشان جدا است.

هر زمان endpoint یا نمونهٔ درخواست/پاسخ برای یکی از سرویس‌ها را فرستادید، همان بخش را کامل و فیکس می‌کنیم.
